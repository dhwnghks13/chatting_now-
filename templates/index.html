<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì±„íŒ…ë°©</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <style>
        /* ê¸°ë³¸ í°íŠ¸ ë° ë°°ê²½ */
        body { padding: 20px; font-family: 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif; background-color: #f0f2f5; }
        
        /* ì±„íŒ… ë°•ìŠ¤ ë””ìì¸ */
        #chatBox { 
            height: 500px; 
            background: white;
            border: 1px solid #ddd; 
            border-radius: 15px; /* ë‘¥ê¸€ê²Œ */
            overflow-y: scroll; 
            padding: 20px; 
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); /* ê·¸ë¦¼ì ì¢€ ë” ê³ ê¸‰ìŠ¤ëŸ½ê²Œ */
        }

        /* ì…ë ¥ì°½ ë””ìì¸ */
        .input-container { display: flex; gap: 10px; }
        #nickname { width: 20%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; }
        #chatInput { width: 60%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; }
        button { 
            width: 20%; padding: 12px; 
            background: #2196f3; /* ì‹œì›í•œ íŒŒë€ìƒ‰ */
            color: white; border: none; border-radius: 8px; 
            cursor: pointer; font-weight: bold; transition: 0.3s; 
        }
        button:hover { background: #1976d2; }

        /* ë©”ì‹œì§€ ë°•ìŠ¤ ê³µí†µ */
        .msg-box { margin-bottom: 12px; }

        /* 1. ì‹œìŠ¤í…œ ì•Œë¦¼ */
        .system { text-align: center; margin: 20px 0; }
        .system span { 
            background-color: #eee; color: #666; 
            padding: 5px 15px; border-radius: 20px; font-size: 12px; 
        }

        /* 2. ì¼ë°˜ì¸ (í‰ë²”í•¨) */
        .normal .nickname { font-weight: bold; color: #555; margin-right: 5px; }
        .normal .message { 
            background-color: #e9efff; padding: 10px 15px; 
            border-radius: 0 15px 15px 15px; /* ë§í’ì„  ëª¨ì–‘ */
            display: inline-block; color: #333;
        }

        /* ğŸ‘‘ 3. ê°œë°œì(ì˜¤ì£¼í™˜) ì „ìš© ë””ìì¸ (ìˆ˜ì •ë¨: ìƒì¡´í˜• ê°„ì§€) */
        .admin { 
            background-color: #e3f2fd; /* ì•„ì£¼ ì—°í•œ í•˜ëŠ˜ìƒ‰ ë°°ê²½ */
            border: 2px solid #2196f3; /* ì¨í•œ íŒŒë€ìƒ‰ í…Œë‘ë¦¬ (ì‹ ë¢°ì˜ ìƒ‰) */
            border-radius: 10px; 
            padding: 10px;
            box-shadow: 0 2px 5px rgba(33, 150, 243, 0.2); /* íŒŒë€ ê·¸ë¦¼ì */
            display: inline-block; /* ë°•ìŠ¤ í¬ê¸° ë‚´ìš©ì— ë§ì¶¤ */
        }
        
        .admin .nickname { 
            color: #0d47a1; /* ì•„ì£¼ ì§„í•œ ë‚¨ìƒ‰ (ê°€ë…ì„± ì¢‹ìŒ) */
            font-weight: 900; 
            font-size: 16px;
            display: block; /* ì´ë¦„ í•œ ì¤„ ì°¨ì§€ */
            margin-bottom: 5px;
        }
        
        /* ì´ë¦„ ì˜†ì— ë¶™ëŠ” ë±ƒì§€ */
        .admin .nickname::after { 
            content: " âœ”ï¸(Official)"; /* ê³µì‹ ì¸ì¦ ë§ˆí¬ ëŠë‚Œ */
            color: #2196f3; 
            font-size: 14px;
        }

        .admin .message { 
            color: #333; 
            font-weight: bold; 
            font-size: 18px; /* ê¸€ì”¨ í¼ */
        }
    </style>
</head>
<body>
    <h1 style="text-align: center; color: #333;">ğŸ’¬ ì±„íŒ…ë°©</h1>
    
    <div id="chatBox"></div>
    
    <div class="input-container">
        <input type="text" id="nickname" placeholder="ë‹‰ë„¤ì„" value="ìµëª…">
        <input type="text" id="chatInput" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..." onkeypress="handleEnter(event)">
        <button onclick="sendMyMessage()">ì „ì†¡</button>
    </div>

    <script>
        var socket = io({transports: ['websocket', 'polling']});

        function sendMyMessage() {
            var nick = document.getElementById('nickname').value;
            var input = document.getElementById('chatInput');
            var msg = input.value;

            if(msg.trim() !== "") {
                socket.emit('my_chat', { name: nick, msg: msg });
                input.value = "";
            }
        }

        function handleEnter(e) {
            if (e.key === "Enter") sendMyMessage();
        }

        socket.on('my_chat', function(data) {
            var chatBox = document.getElementById('chatBox');
            var html = "";


            if (data.role === 'system') {
                html = `<div class='system'><span>${data.msg}</span></div>`;
            } else if (data.role === 'admin') {
                // ëŒ€ì¥ë‹˜ ë””ìì¸
                html = `
                    <div style="text-align: right;"> <div class='msg-box admin'>
                            <span class='nickname'>${data.name}</span>
                            <span class='message'>${data.msg}</span>
                        </div>
                    </div>`;
            } else {
                // ì¼ë°˜ì¸ ë””ìì¸
                html = `
                    <div class='msg-box normal'>
                        <span class='nickname'>${data.name}:</span>
                        <span class='message'>${data.msg}</span>
                    </div>`;
            }

            chatBox.innerHTML += html;
            chatBox.scrollTop = chatBox.scrollHeight;
        });
                    socket.on('disconnect', function() {
            var chatBox = document.getElementById('chatBox');
            chatBox.innerHTML += "<div class='system' style='color:red; font-weight:bold;'>ğŸš« ì„œë²„ì™€ì˜ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤. (ê°•í‡´ë‹¹í–ˆì„ ìˆ˜ ìˆìŒ)</div>";
            chatBox.scrollTop = chatBox.scrollHeight;
            
            // ì…ë ¥ì°½ ì ê·¸ê¸° (ë” ì´ìƒ ì±„íŒ… ëª» ì¹˜ê²Œ)
            document.getElementById('chatInput').disabled = true;
            document.getElementById('nickname').disabled = true;
            document.querySelector('button').disabled = true;
            
            alert("ì„œë²„ì™€ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤.");
    </script>
</body>
</html>



