<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì±„íŒ…ë°©</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <style>
        body { padding: 20px; font-family: 'Apple SD Gothic Neo', sans-serif; background-color: #f0f2f5; }
        h1 { text-align: center; color: #333; }
        
        #chatBox { 
            height: 500px; 
            background: white;
            border: 1px solid #ddd; 
            border-radius: 10px;
            overflow-y: scroll; 
            padding: 15px; 
            margin-bottom: 15px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        /* ì±„íŒ… ë©”ì‹œì§€ ìŠ¤íƒ€ì¼ */
        .msg-box { margin-bottom: 10px; }
        .nickname { font-weight: bold; color: #555; font-size: 14px; margin-right: 5px; }
        .message { background-color: #e9efff; padding: 5px 10px; border-radius: 8px; display: inline-block; }
        .system { color: #888; text-align: center; font-size: 13px; margin: 10px 0; }

        /* ì…ë ¥ì°½ ìŠ¤íƒ€ì¼ */
        .input-container { display: flex; gap: 10px; }
        #nickname { width: 20%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; }
        #chatInput { width: 60%; padding: 10px; border-radius: 5px; border: 1px solid #ccc; }
        button { width: 20%; padding: 10px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button:hover { background: #0056b3; }
    </style>
</head>
<body>
    <h1>ì±„íŒ…ë°©4-1<h1>
    
    <div id="chatBox"></div>
    
    <div class="input-container">
        <input type="text" id="nickname" placeholder="ë‹‰ë„¤ì„" value="ìµëª…">
        <input type="text" id="chatInput" placeholder="ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”...">
        <button onclick="sendMyMessage()">ì „ì†¡</button>
    </div>

    <script>
        var socket = io({transports: ['websocket', 'polling']});

        // 1. ë©”ì‹œì§€ ë³´ë‚´ê¸°
        function sendMyMessage() {
            var nick = document.getElementById('nickname').value;
            var input = document.getElementById('chatInput');
            var msg = input.value;

            if(msg.trim() !== "") {
                // ğŸ‘‡ ì´ë¦„ê³¼ ë©”ì‹œì§€ë¥¼ ë¬¶ì–´ì„œ ë³´ëƒ„ (JSON ê°ì²´)
                var data = { name: nick, msg: msg };
                socket.emit('my_chat', data); 
                input.value = "";
            }
        }

        // 2. ë©”ì‹œì§€ ë°›ê¸° (ì´ë¦„ + ë‚´ìš© ë¶„ë¦¬í•´ì„œ ë³´ì—¬ì¤Œ)
        socket.on('my_chat', function(data) {
            var chatBox = document.getElementById('chatBox');
            
            // ì•Œë¦¼ ë©”ì‹œì§€ì¸ ê²½ìš° ë””ìì¸ ë‹¤ë¥´ê²Œ
            if(data.name === 'ğŸ“¢ ì•Œë¦¼') {
                chatBox.innerHTML += `<div class='system'>${data.msg}</div>`;
            } else {
                // ì¼ë°˜ ë©”ì‹œì§€ (ë‹‰ë„¤ì„ êµµê²Œ í‘œì‹œ)
                chatBox.innerHTML += `
                    <div class='msg-box'>
                        <span class='nickname'>${data.name}:</span>
                        <span class='message'>${data.msg}</span>
                    </div>`;
            }
            chatBox.scrollTop = chatBox.scrollHeight;
        });

        // ì—”í„°í‚¤ ê¸°ëŠ¥
        document.getElementById("chatInput").addEventListener("keyup", function(event) {
            if (event.key === "Enter") sendMyMessage();
        });
    </script>
</body>
</html>
